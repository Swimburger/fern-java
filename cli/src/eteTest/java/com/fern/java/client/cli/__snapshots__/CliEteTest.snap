basic[basic/generated-java/basic-client/build.gradle]=[
plugins {
    id 'java-library'
    id "org.inferred.processors" version "3.6.0"
}

repositories {
    mavenCentral()
    maven {
        url "https://s01.oss.sonatype.org/content/repositories/releases/"
    }
}

dependencies {
    api project(':basic-model')
    api 'io.github.fern-api:exception-utils:0.0.82'
    api 'io.github.fern-api:immutables-utils:0.0.82'
    api 'io.github.fern-api:jackson-utils:0.0.82'
    implementation 'io.github.fern-api:jersey-utils:0.0.82'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.12.3'
    implementation 'com.fasterxml.jackson.datatype:jackson-datatype-jdk8:2.12.3'
    implementation 'io.github.openfeign:feign-jackson:11.8'
    implementation 'io.github.openfeign:feign-core:11.8'
    implementation 'io.github.openfeign:feign-jaxrs2:11.8'

    annotationProcessor 'org.immutables:value:2.8.8'
    compileOnly 'org.immutables:value-annotations:2.8.8'
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/BearerAuth.java]=[
package com.fern.basic.client;

import com.fasterxml.jackson.annotation.JsonValue;
import java.lang.Override;
import java.lang.String;
import org.immutables.value.Value;

@Value.Immutable
@Value.Style(
    visibility = Value.Style.ImplementationVisibility.PACKAGE,
    jdkOnly = true
)
public abstract class BearerAuth {
  @Value.Parameter
  @JsonValue
  public abstract String getToken();

  @Override
  public final String toString() {
    return "Bearer " + getToken();
  }

  public static BearerAuth of(String token) {
    return ImmutableBearerAuth.of(token.startsWith("Bearer ") ? token.substring(7) : token);
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/FernBasicClient.java]=[
package com.fern.basic.client;

import com.fern.basic.client.blog.PostsServiceClient;
import com.fern.basic.client.dummy.service.DummyServiceClient;
import java.lang.String;
import java.util.Objects;
import java.util.concurrent.atomic.AtomicReference;
import java.util.function.Supplier;

public final class FernBasicClient {
  private final Supplier<PostsServiceClient> postsServiceClient;

  private final Supplier<DummyServiceClient> dummyServiceClient;

  public FernBasicClient(String url) {
    this.postsServiceClient = memoize(() -> new PostsServiceClient(url));
    this.dummyServiceClient = memoize(() -> new DummyServiceClient(url));
  }

  public FernBasicClient(String url, BearerAuth auth) {
    this.postsServiceClient = memoize(() -> new PostsServiceClient(url, auth));
    this.dummyServiceClient = memoize(() -> new DummyServiceClient(url, auth));
  }

  public final PostsServiceClient blog() {
    return this.postsServiceClient.get();
  }

  public final DummyServiceClient dummyService() {
    return this.dummyServiceClient.get();
  }

  private static <T> Supplier<T> memoize(Supplier<T> delegate) {
    AtomicReference<T> value = new AtomicReference<>();
    return () ->  {
      T val = value.get();
      if (val == null) {
        val = value.updateAndGet(cur -> cur == null ? Objects.requireNonNull(delegate.get()) : cur);
      }
      return val;
    } ;
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/blog/PostsService.java]=[
package com.fern.basic.client.blog;

import com.fern.basic.model.blog.BlogPost;
import com.fern.basic.model.blog.CreatePostRequest;
import com.fern.basic.model.blog.PostId;
import com.fern.basic.model.blog.PostNotFoundError;
import com.fern.java.exception.UnknownRemoteException;
import com.fern.java.jackson.ClientObjectMappers;
import com.fern.java.jersey.contracts.OptionalAwareContract;
import feign.Feign;
import feign.jackson.JacksonDecoder;
import feign.jackson.JacksonEncoder;
import feign.jaxrs.JAXRSContract;
import java.lang.String;
import javax.ws.rs.Consumes;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
@Path("/posts")
interface PostsService {
  @POST
  @Path("/create")
  void createPost(CreatePostRequest body);

  @GET
  @Path("/{postId}")
  BlogPost getPost(@PathParam("postId") PostId postId) throws PostNotFoundError,
      UnknownRemoteException;

  static PostsService getClient(String url) {
    return Feign.builder()
        .contract(new OptionalAwareContract(new JAXRSContract()))
        .decoder(new JacksonDecoder(ClientObjectMappers.JSON_MAPPER))
        .encoder(new JacksonEncoder(ClientObjectMappers.JSON_MAPPER))
        .errorDecoder(new PostsServiceErrorDecoder()).target(PostsService.class, url);
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/blog/PostsServiceClient.java]=[
package com.fern.basic.client.blog;

import com.fern.basic.client.BearerAuth;
import com.fern.basic.model.blog.BlogPost;
import com.fern.basic.model.blog.CreatePostRequest;
import com.fern.basic.model.blog.PostId;
import com.fern.basic.model.blog.PostNotFoundError;
import com.fern.java.exception.UnknownRemoteException;
import java.lang.String;
import java.util.Optional;

public final class PostsServiceClient {
  private final PostsService service;

  private final Optional<BearerAuth> auth;

  public PostsServiceClient(String url) {
    this.service = PostsService.getClient(url);
    this.auth = Optional.empty();
  }

  public PostsServiceClient(String url, BearerAuth auth) {
    this.service = PostsService.getClient(url);
    this.auth = Optional.of(auth);
  }

  public void createPost(CreatePostRequest body) {
    this.service.createPost(body);
  }

  public BlogPost getPost(PostId postId) throws PostNotFoundError, UnknownRemoteException {
    return this.service.getPost(postId);
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/blog/PostsServiceErrorDecoder.java]=[
package com.fern.basic.client.blog;

import com.fern.basic.model.blog.GetPostFailedResponse;
import com.fern.java.exception.UnknownRemoteException;
import com.fern.java.jackson.ClientObjectMappers;
import feign.Response;
import feign.codec.ErrorDecoder;
import java.io.IOException;
import java.lang.Class;
import java.lang.Exception;
import java.lang.Override;
import java.lang.String;
import java.util.function.Function;

final class PostsServiceErrorDecoder implements ErrorDecoder {
  @Override
  public Exception decode(String methodKey, Response response) {
    if (methodKey.contains("getPost")) {
      return decodeException(response, GetPostFailedResponse.class, GetPostFailedResponse::getException);
    }
    return new UnknownRemoteException("Encountered exception for unknown method: " + methodKey);
  }

  private static <T> Exception decodeException(Response response, Class<T> clazz,
      Function<T, Exception> exceptionRetriever) {
    try {
      T value = ClientObjectMappers.JSON_MAPPER.readValue(response.body().asInputStream(), clazz);
      return exceptionRetriever.apply(value);
    }
    catch (IOException e) {
      return new UnknownRemoteException("Failed to read error body");
    }
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/blog/errors/PostNotFoundError.java]=[
package com.fern.basic.client.blog.errors;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSetter;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.fern.basic.model.blog.PostId;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Objects;

@JsonDeserialize(
    builder = PostNotFoundError.Builder.class
)
public final class PostNotFoundError {
  private final PostId id;

  private int _cachedHashCode;

  PostNotFoundError(PostId id) {
    this.id = id;
  }

  @JsonProperty("id")
  public PostId getId() {
    return id;
  }

  @Override
  public boolean equals(Object other) {
    if (this == other) return true;
    return other instanceof PostNotFoundError && equalTo((PostNotFoundError) other);
  }

  private boolean equalTo(PostNotFoundError other) {
    return id.equals(other.id);
  }

  @Override
  public int hashCode() {
    if (_cachedHashCode == 0) {
      _cachedHashCode = Objects.hash(this.id);
    }
    return _cachedHashCode;
  }

  @Override
  public String toString() {
    return "PostNotFoundError{" + "id: " + id + "}";
  }

  public static IdStage builder() {
    return new Builder();
  }

  public interface IdStage {
    _FinalStage id(PostId id);

    Builder from(PostNotFoundError other);
  }

  public interface _FinalStage {
    PostNotFoundError build();
  }

  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  static final class Builder implements IdStage, _FinalStage {
    private PostId id;

    private Builder() {
    }

    @Override
    public Builder from(PostNotFoundError other) {
      id(other.getId());
      return this;
    }

    @Override
    @JsonSetter("id")
    public _FinalStage id(PostId id) {
      this.id = id;
      return this;
    }

    @Override
    public PostNotFoundError build() {
      return new PostNotFoundError(id);
    }
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/blog/errors/UnauthorizedError.java]=[
package com.fern.basic.client.blog.errors;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSetter;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Objects;

@JsonDeserialize(
    builder = UnauthorizedError.Builder.class
)
public final class UnauthorizedError {
  private final String reason;

  private int _cachedHashCode;

  UnauthorizedError(String reason) {
    this.reason = reason;
  }

  @JsonProperty("reason")
  public String getReason() {
    return reason;
  }

  @Override
  public boolean equals(Object other) {
    if (this == other) return true;
    return other instanceof UnauthorizedError && equalTo((UnauthorizedError) other);
  }

  private boolean equalTo(UnauthorizedError other) {
    return reason.equals(other.reason);
  }

  @Override
  public int hashCode() {
    if (_cachedHashCode == 0) {
      _cachedHashCode = Objects.hash(this.reason);
    }
    return _cachedHashCode;
  }

  @Override
  public String toString() {
    return "UnauthorizedError{" + "reason: " + reason + "}";
  }

  public static ReasonStage builder() {
    return new Builder();
  }

  public interface ReasonStage {
    _FinalStage reason(String reason);

    Builder from(UnauthorizedError other);
  }

  public interface _FinalStage {
    UnauthorizedError build();
  }

  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  static final class Builder implements ReasonStage, _FinalStage {
    private String reason;

    private Builder() {
    }

    @Override
    public Builder from(UnauthorizedError other) {
      reason(other.getReason());
      return this;
    }

    @Override
    @JsonSetter("reason")
    public _FinalStage reason(String reason) {
      this.reason = reason;
      return this;
    }

    @Override
    public UnauthorizedError build() {
      return new UnauthorizedError(reason);
    }
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/dummy/service/DummyService.java]=[
package com.fern.basic.client.dummy.service;

import com.fern.basic.client.BearerAuth;
import com.fern.basic.model.dummy.service.DummyId;
import com.fern.java.jackson.ClientObjectMappers;
import com.fern.java.jersey.contracts.OptionalAwareContract;
import feign.Feign;
import feign.jackson.JacksonDecoder;
import feign.jackson.JacksonEncoder;
import feign.jaxrs.JAXRSContract;
import java.lang.String;
import javax.ws.rs.Consumes;
import javax.ws.rs.GET;
import javax.ws.rs.HeaderParam;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
@Path("/dummy")
interface DummyService {
  @GET
  @Path("/")
  void getDummy(@HeaderParam("Authorization") BearerAuth bearer, DummyId body);

  static DummyService getClient(String url) {
    return Feign.builder()
        .contract(new OptionalAwareContract(new JAXRSContract()))
        .decoder(new JacksonDecoder(ClientObjectMappers.JSON_MAPPER))
        .encoder(new JacksonEncoder(ClientObjectMappers.JSON_MAPPER))
        .target(DummyService.class, url);
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/dummy/service/DummyServiceClient.java]=[
package com.fern.basic.client.dummy.service;

import com.fern.basic.client.BearerAuth;
import com.fern.basic.client.dummy.service.endpoints.GetDummy;
import java.lang.RuntimeException;
import java.lang.String;
import java.util.Optional;

public final class DummyServiceClient {
  private final DummyService service;

  private final Optional<BearerAuth> auth;

  public DummyServiceClient(String url) {
    this.service = DummyService.getClient(url);
    this.auth = Optional.empty();
  }

  public DummyServiceClient(String url, BearerAuth auth) {
    this.service = DummyService.getClient(url);
    this.auth = Optional.of(auth);
  }

  public void getDummy(GetDummy.Request request) {
    BearerAuth authValue = request.getAuthOverride().orElse(this.auth.orElseThrow(() -> new RuntimeException("Auth is required for getDummy")));
    this.service.getDummy(authValue, request.getBody());
  }
}

]


basic[basic/generated-java/basic-client/src/main/java/com/fern/basic/client/dummy/service/endpoints/GetDummy.java]=[
package com.fern.basic.client.dummy.service.endpoints;

import com.fern.basic.client.BearerAuth;
import com.fern.basic.model.dummy.service.DummyId;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Objects;
import java.util.Optional;

public final class GetDummy {
  private GetDummy() {
  }

  public static final class Request {
    private final Optional<BearerAuth> authOverride;

    private final DummyId body;

    private int _cachedHashCode;

    Request(Optional<BearerAuth> authOverride, DummyId body) {
      this.authOverride = authOverride;
      this.body = body;
    }

    public Optional<BearerAuth> getAuthOverride() {
      return authOverride;
    }

    public DummyId getBody() {
      return body;
    }

    @Override
    public boolean equals(Object other) {
      if (this == other) return true;
      return other instanceof Request && equalTo((Request) other);
    }

    private boolean equalTo(Request other) {
      return authOverride.equals(other.authOverride) && body.equals(other.body);
    }

    @Override
    public int hashCode() {
      if (_cachedHashCode == 0) {
        _cachedHashCode = Objects.hash(this.authOverride, this.body);
      }
      return _cachedHashCode;
    }

    @Override
    public String toString() {
      return "GetDummy.Request{" + "authOverride: " + authOverride + ", body: " + body + "}";
    }

    public static BodyStage builder() {
      return new Builder();
    }

    public interface BodyStage {
      _FinalStage body(DummyId body);

      Builder from(Request other);
    }

    public interface _FinalStage {
      Request build();

      _FinalStage authOverride(Optional<BearerAuth> authOverride);

      _FinalStage authOverride(BearerAuth authOverride);
    }

    static final class Builder implements BodyStage, _FinalStage {
      private DummyId body;

      private Optional<BearerAuth> authOverride = Optional.empty();

      private Builder() {
      }

      @Override
      public Builder from(Request other) {
        authOverride(other.getAuthOverride());
        body(other.getBody());
        return this;
      }

      @Override
      public _FinalStage body(DummyId body) {
        this.body = body;
        return this;
      }

      @Override
      public _FinalStage authOverride(BearerAuth authOverride) {
        this.authOverride = Optional.of(authOverride);
        return this;
      }

      @Override
      public _FinalStage authOverride(Optional<BearerAuth> authOverride) {
        this.authOverride = authOverride;
        return this;
      }

      @Override
      public Request build() {
        return new Request(authOverride, body);
      }
    }
  }
}

]


basic[basic/generated-java/basic-model/build.gradle]=[
plugins {
    id 'java-library'
    id "org.inferred.processors" version "3.6.0"
}

repositories {
    mavenCentral()
    maven {
        url "https://s01.oss.sonatype.org/content/repositories/releases/"
    }
}

dependencies {
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.12.3'
    implementation 'com.google.code.findbugs:annotations:3.0.1'
    api 'io.github.fern-api:exception-utils:0.0.82'
    api 'io.github.fern-api:immutables-utils:0.0.82'

    annotationProcessor 'org.immutables:value:2.8.8'
    compileOnly 'org.immutables:value-annotations:2.8.8'
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/Age.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonCreator;
import java.lang.Integer;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;

public final class Age {
  private final int value;

  private Age(int value) {
    this.value = value;
  }

  @JsonCreator(
      mode = JsonCreator.Mode.DELEGATING
  )
  public static Age of(int value) {
    return new Age(value);
  }

  @Override
  public boolean equals(Object other) {
    return this == other || (other instanceof Age && this.value == ((Age) other).value);
  }

  @Override
  public int hashCode() {
    return Integer.hashCode(value);
  }

  @Override
  public String toString() {
    return Integer.toString(value);
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/Author.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSubTypes;
import com.fasterxml.jackson.annotation.JsonTypeInfo;
import com.fasterxml.jackson.annotation.JsonTypeName;
import com.fasterxml.jackson.annotation.JsonValue;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Map;
import java.util.Objects;
import java.util.Optional;
import org.immutables.value.Value;

@Value.Enclosing
public final class Author {
  private final InternalValue value;

  @JsonCreator(
      mode = JsonCreator.Mode.DELEGATING
  )
  private Author(InternalValue value) {
    this.value = value;
  }

  @JsonValue
  InternalValue getInternalValue() {
    return value;
  }

  @Override
  public boolean equals(Object other) {
    return this == other || (other instanceof Author && equalTo((Author) other));
  }

  private boolean equalTo(Author other) {
    return this.value.equals(other.value);
  }

  @Override
  public int hashCode() {
    return Objects.hashCode(this.value);
  }

  public static Author anonymous() {
    return new Author(InternalAnonymousValue.of());
  }

  public static Author name(String value) {
    return new Author(InternalNameValue.of(value));
  }

  public boolean isAnonymous() {
    return value instanceof InternalAnonymousValue;
  }

  public boolean isName() {
    return value instanceof InternalNameValue;
  }

  public Optional<String> getName() {
    if (isName()) {
      return Optional.of(((InternalNameValue) value).name());
    }
    return Optional.empty();
  }

  public <T> T visit(Visitor<T> visitor) {
    return value.visit(visitor);
  }

  public interface Visitor<T> {
    T visitAnonymous();

    T visitName(String value);

    T visitUnknown(String unknownType);
  }

  @JsonTypeInfo(
      use = JsonTypeInfo.Id.NAME,
      include = JsonTypeInfo.As.PROPERTY,
      property = "_type",
      visible = true,
      defaultImpl = Unknown.class
  )
  @JsonSubTypes({
      @JsonSubTypes.Type(value = InternalAnonymousValue.class, name = "WireStringWithAllCasings{originalValue=anonymous, camelCase=anonymous, pascalCase=Anonymous, snakeCase=anonymous, screamingSnakeCase=ANONYMOUS, wireValue=anonymous}"),
      @JsonSubTypes.Type(value = InternalNameValue.class, name = "WireStringWithAllCasings{originalValue=name, camelCase=name, pascalCase=Name, snakeCase=name, screamingSnakeCase=NAME, wireValue=name}")
  })
  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  private interface InternalValue {
    <T> T visit(Visitor<T> visitor);
  }

  @Value.Immutable
  @JsonTypeName("WireStringWithAllCasings{originalValue=anonymous, camelCase=anonymous, pascalCase=Anonymous, snakeCase=anonymous, screamingSnakeCase=ANONYMOUS, wireValue=anonymous}")
  @JsonDeserialize(
      as = ImmutableAuthor.InternalAnonymousValue.class
  )
  interface InternalAnonymousValue extends InternalValue {
    @Override
    default <T> T visit(Visitor<T> visitor) {
      return visitor.visitAnonymous();
    }

    static InternalAnonymousValue of() {
      return ImmutableAuthor.InternalAnonymousValue.builder().build();
    }
  }

  @Value.Immutable
  @JsonTypeName("WireStringWithAllCasings{originalValue=name, camelCase=name, pascalCase=Name, snakeCase=name, screamingSnakeCase=NAME, wireValue=name}")
  @JsonDeserialize(
      as = ImmutableAuthor.InternalNameValue.class
  )
  interface InternalNameValue extends InternalValue {
    @JsonProperty("name")
    String name();

    @Override
    default <T> T visit(Visitor<T> visitor) {
      return visitor.visitName(name());
    }

    static InternalNameValue of(String value) {
      return ImmutableAuthor.InternalNameValue.builder().name(value).build();
    }
  }

  @Value.Immutable
  @JsonDeserialize(
      as = ImmutableAuthor.Unknown.class
  )
  interface Unknown extends InternalValue {
    @JsonValue
    Map<String, Object> value();

    default String type() {
      return value().get("type").toString();
    }

    @Override
    default <T> T visit(Visitor<T> visitor) {
      return visitor.visitUnknown(type());
    }
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/BlogPost.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSetter;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Objects;

@JsonDeserialize(
    builder = BlogPost.Builder.class
)
public final class BlogPost {
  private final PostId id;

  private final PostType type;

  private final String title;

  private final Author author;

  private final String content;

  private int _cachedHashCode;

  BlogPost(PostId id, PostType type, String title, Author author, String content) {
    this.id = id;
    this.type = type;
    this.title = title;
    this.author = author;
    this.content = content;
  }

  @JsonProperty("id")
  public PostId getId() {
    return id;
  }

  @JsonProperty("type")
  public PostType getType() {
    return type;
  }

  @JsonProperty("title")
  public String getTitle() {
    return title;
  }

  @JsonProperty("author")
  public Author getAuthor() {
    return author;
  }

  @JsonProperty("content")
  public String getContent() {
    return content;
  }

  @Override
  public boolean equals(Object other) {
    if (this == other) return true;
    return other instanceof BlogPost && equalTo((BlogPost) other);
  }

  private boolean equalTo(BlogPost other) {
    return id.equals(other.id) && type.equals(other.type) && title.equals(other.title) && author.equals(other.author) && content.equals(other.content);
  }

  @Override
  public int hashCode() {
    if (_cachedHashCode == 0) {
      _cachedHashCode = Objects.hash(this.id, this.type, this.title, this.author, this.content);
    }
    return _cachedHashCode;
  }

  @Override
  public String toString() {
    return "BlogPost{" + "id: " + id + ", type: " + type + ", title: " + title + ", author: " + author + ", content: " + content + "}";
  }

  public static IdStage builder() {
    return new Builder();
  }

  public interface IdStage {
    TypeStage id(PostId id);

    Builder from(BlogPost other);
  }

  public interface TypeStage {
    TitleStage type(PostType type);
  }

  public interface TitleStage {
    AuthorStage title(String title);
  }

  public interface AuthorStage {
    ContentStage author(Author author);
  }

  public interface ContentStage {
    _FinalStage content(String content);
  }

  public interface _FinalStage {
    BlogPost build();
  }

  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  static final class Builder implements IdStage, TypeStage, TitleStage, AuthorStage, ContentStage, _FinalStage {
    private PostId id;

    private PostType type;

    private String title;

    private Author author;

    private String content;

    private Builder() {
    }

    @Override
    public Builder from(BlogPost other) {
      id(other.getId());
      type(other.getType());
      title(other.getTitle());
      author(other.getAuthor());
      content(other.getContent());
      return this;
    }

    @Override
    @JsonSetter("id")
    public TypeStage id(PostId id) {
      this.id = id;
      return this;
    }

    @Override
    @JsonSetter("type")
    public TitleStage type(PostType type) {
      this.type = type;
      return this;
    }

    @Override
    @JsonSetter("title")
    public AuthorStage title(String title) {
      this.title = title;
      return this;
    }

    @Override
    @JsonSetter("author")
    public ContentStage author(Author author) {
      this.author = author;
      return this;
    }

    @Override
    @JsonSetter("content")
    public _FinalStage content(String content) {
      this.content = content;
      return this;
    }

    @Override
    public BlogPost build() {
      return new BlogPost(id, type, title, author, content);
    }
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/CreatePostRequest.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSetter;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Objects;

@JsonDeserialize(
    builder = CreatePostRequest.Builder.class
)
public final class CreatePostRequest {
  private final String title;

  private final Author author;

  private final String content;

  private final PostType postType;

  private final int _switch;

  private int _cachedHashCode;

  CreatePostRequest(String title, Author author, String content, PostType postType, int _switch) {
    this.title = title;
    this.author = author;
    this.content = content;
    this.postType = postType;
    this._switch = _switch;
  }

  @JsonProperty("title")
  public String getTitle() {
    return title;
  }

  @JsonProperty("author")
  public Author getAuthor() {
    return author;
  }

  @JsonProperty("content")
  public String getContent() {
    return content;
  }

  @JsonProperty("postType")
  public PostType getPostType() {
    return postType;
  }

  @JsonProperty("switch")
  public int getSwitch() {
    return _switch;
  }

  @Override
  public boolean equals(Object other) {
    if (this == other) return true;
    return other instanceof CreatePostRequest && equalTo((CreatePostRequest) other);
  }

  private boolean equalTo(CreatePostRequest other) {
    return title.equals(other.title) && author.equals(other.author) && content.equals(other.content) && postType.equals(other.postType) && _switch == other._switch;
  }

  @Override
  public int hashCode() {
    if (_cachedHashCode == 0) {
      _cachedHashCode = Objects.hash(this.title, this.author, this.content, this.postType, this._switch);
    }
    return _cachedHashCode;
  }

  @Override
  public String toString() {
    return "CreatePostRequest{" + "title: " + title + ", author: " + author + ", content: " + content + ", postType: " + postType + ", _switch: " + _switch + "}";
  }

  public static TitleStage builder() {
    return new Builder();
  }

  public interface TitleStage {
    AuthorStage title(String title);

    Builder from(CreatePostRequest other);
  }

  public interface AuthorStage {
    ContentStage author(Author author);
  }

  public interface ContentStage {
    PostTypeStage content(String content);
  }

  public interface PostTypeStage {
    SwitchStage postType(PostType postType);
  }

  public interface SwitchStage {
    _FinalStage _switch(int _switch);
  }

  public interface _FinalStage {
    CreatePostRequest build();
  }

  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  static final class Builder implements TitleStage, AuthorStage, ContentStage, PostTypeStage, SwitchStage, _FinalStage {
    private String title;

    private Author author;

    private String content;

    private PostType postType;

    private int _switch;

    private Builder() {
    }

    @Override
    public Builder from(CreatePostRequest other) {
      title(other.getTitle());
      author(other.getAuthor());
      content(other.getContent());
      postType(other.getPostType());
      _switch(other.getSwitch());
      return this;
    }

    @Override
    @JsonSetter("title")
    public AuthorStage title(String title) {
      this.title = title;
      return this;
    }

    @Override
    @JsonSetter("author")
    public ContentStage author(Author author) {
      this.author = author;
      return this;
    }

    @Override
    @JsonSetter("content")
    public PostTypeStage content(String content) {
      this.content = content;
      return this;
    }

    @Override
    @JsonSetter("postType")
    public SwitchStage postType(PostType postType) {
      this.postType = postType;
      return this;
    }

    @Override
    @JsonSetter("switch")
    public _FinalStage _switch(int _switch) {
      this._switch = _switch;
      return this;
    }

    @Override
    public CreatePostRequest build() {
      return new CreatePostRequest(title, author, content, postType, _switch);
    }
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/GetPostFailedResponse.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSubTypes;
import com.fasterxml.jackson.annotation.JsonTypeInfo;
import com.fasterxml.jackson.annotation.JsonTypeName;
import com.fasterxml.jackson.annotation.JsonUnwrapped;
import com.fasterxml.jackson.annotation.JsonValue;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.fern.java.exception.HttpException;
import java.lang.Exception;
import java.lang.String;
import org.immutables.value.Value;

@Value.Enclosing
public final class GetPostFailedResponse {
  private final InternalValue value;

  @JsonCreator(
      mode = JsonCreator.Mode.DELEGATING
  )
  private GetPostFailedResponse(InternalValue value) {
    this.value = value;
  }

  @JsonValue
  InternalValue getInternalValue() {
    return value;
  }

  public final Exception getException() {
    return value.getException();
  }

  public static GetPostFailedResponse postNotFoundError(PostNotFoundError value) {
    return new GetPostFailedResponse(InternalPostNotFoundErrorValue.of(value));
  }

  @JsonTypeInfo(
      use = JsonTypeInfo.Id.NAME,
      include = JsonTypeInfo.As.PROPERTY,
      property = "_error",
      visible = true
  )
  @JsonSubTypes(@JsonSubTypes.Type(value = InternalPostNotFoundErrorValue.class, name = "PostNotFoundError"))
  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  private interface InternalValue<T extends HttpException> {
    @JsonIgnore
    T getException();

    @JsonProperty("_errorInstanceId")
    default String getErrorInstanceId() {
      return getException().getErrorInstanceId();
    }
  }

  @Value.Immutable
  @JsonTypeName("PostNotFoundError")
  @JsonDeserialize(
      as = GetPostFailedResponse.InternalPostNotFoundErrorValue.class
  )
  interface InternalPostNotFoundErrorValue extends InternalValue<PostNotFoundError> {
    @Value.Derived
    @JsonUnwrapped
    default PostNotFoundErrorBody body() {
      return getException().getBody();
    }

    static InternalPostNotFoundErrorValue of(PostNotFoundError value) {
      return ImmutableGetPostFailedResponse.InternalPostNotFoundErrorValue.builder().exception(value).build();
    }
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/PostId.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonCreator;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;

public final class PostId {
  private final String value;

  private PostId(String value) {
    this.value = value;
  }

  @JsonCreator(
      mode = JsonCreator.Mode.DELEGATING
  )
  public static PostId of(String value) {
    return new PostId(value);
  }

  @Override
  public boolean equals(Object other) {
    return this == other || (other instanceof PostId && this.value.equals(((PostId) other).value));
  }

  @Override
  public int hashCode() {
    return value.hashCode();
  }

  @Override
  public String toString() {
    return value;
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/PostNotFoundError.java]=[
package com.fern.basic.model.blog;

import com.fern.java.exception.HttpException;
import java.lang.Override;

public final class PostNotFoundError extends HttpException {
  PostNotFoundErrorBody body;

  public PostNotFoundError(PostNotFoundErrorBody body) {
    this.body = body;
  }

  public PostNotFoundErrorBody getBody() {
    return body;
  }

  @Override
  public int getStatusCode() {
    return 400;
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/PostNotFoundErrorBody.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSetter;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Objects;

@JsonDeserialize(
    builder = PostNotFoundErrorBody.Builder.class
)
public final class PostNotFoundErrorBody {
  private final PostId id;

  private int _cachedHashCode;

  PostNotFoundErrorBody(PostId id) {
    this.id = id;
  }

  @JsonProperty("id")
  public PostId getId() {
    return id;
  }

  @Override
  public boolean equals(Object other) {
    if (this == other) return true;
    return other instanceof PostNotFoundErrorBody && equalTo((PostNotFoundErrorBody) other);
  }

  private boolean equalTo(PostNotFoundErrorBody other) {
    return id.equals(other.id);
  }

  @Override
  public int hashCode() {
    if (_cachedHashCode == 0) {
      _cachedHashCode = Objects.hash(this.id);
    }
    return _cachedHashCode;
  }

  @Override
  public String toString() {
    return "PostNotFoundErrorBody{" + "id: " + id + "}";
  }

  public static IdStage builder() {
    return new Builder();
  }

  public interface IdStage {
    _FinalStage id(PostId id);

    Builder from(PostNotFoundErrorBody other);
  }

  public interface _FinalStage {
    PostNotFoundErrorBody build();
  }

  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  static final class Builder implements IdStage, _FinalStage {
    private PostId id;

    private Builder() {
    }

    @Override
    public Builder from(PostNotFoundErrorBody other) {
      id(other.getId());
      return this;
    }

    @Override
    @JsonSetter("id")
    public _FinalStage id(PostId id) {
      this.id = id;
      return this;
    }

    @Override
    public PostNotFoundErrorBody build() {
      return new PostNotFoundErrorBody(id);
    }
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/PostType.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonValue;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Locale;
import javax.annotation.Nonnull;

public final class PostType {
  public static final PostType MEDIUM = new PostType(Value.MEDIUM, "med.med");

  public static final PostType LONG = new PostType(Value.LONG, "LONG");

  public static final PostType SHORT = new PostType(Value.SHORT, "SHORT");

  private final Value value;

  private final String string;

  PostType(Value value, String string) {
    this.value = value;
    this.string = string;
  }

  public Value getEnumValue() {
    return value;
  }

  @Override
  @JsonValue
  public String toString() {
    return this.string;
  }

  @Override
  public boolean equals(Object other) {
    return (this == other) 
      || (other instanceof PostType && this.string.equals(((PostType) other).string));
  }

  @Override
  public int hashCode() {
    return this.string.hashCode();
  }

  public <T> T visit(Visitor<T> visitor) {
    switch (value) {
      case MEDIUM:
        return visitor.visitMedium();
      case LONG:
        return visitor.visitLong();
      case SHORT:
        return visitor.visitShort();
      case UNKNOWN:
      default:
        return visitor.visitUnknown(string);
    }
  }

  @JsonCreator(
      mode = JsonCreator.Mode.DELEGATING
  )
  public static PostType valueOf(@Nonnull String value) {
    String upperCasedValue = value.toUpperCase(Locale.ROOT);
    switch (upperCasedValue) {
      case "med.med":
        return MEDIUM;
      case "LONG":
        return LONG;
      case "SHORT":
        return SHORT;
      default:
        return new PostType(Value.UNKNOWN, upperCasedValue);
    }
  }

  public enum Value {
    LONG,

    SHORT,

    MEDIUM,

    UNKNOWN
  }

  public interface Visitor<T> {
    T visitLong();

    T visitShort();

    T visitMedium();

    T visitUnknown(String unknownType);
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/UnauthorizedError.java]=[
package com.fern.basic.model.blog;

import com.fern.java.exception.HttpException;
import java.lang.Override;

public final class UnauthorizedError extends HttpException {
  UnauthorizedErrorBody body;

  public UnauthorizedError(UnauthorizedErrorBody body) {
    this.body = body;
  }

  public UnauthorizedErrorBody getBody() {
    return body;
  }

  @Override
  public int getStatusCode() {
    return 403;
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/blog/UnauthorizedErrorBody.java]=[
package com.fern.basic.model.blog;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonSetter;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;
import java.util.Objects;

@JsonDeserialize(
    builder = UnauthorizedErrorBody.Builder.class
)
public final class UnauthorizedErrorBody {
  private final String reason;

  private int _cachedHashCode;

  UnauthorizedErrorBody(String reason) {
    this.reason = reason;
  }

  @JsonProperty("reason")
  public String getReason() {
    return reason;
  }

  @Override
  public boolean equals(Object other) {
    if (this == other) return true;
    return other instanceof UnauthorizedErrorBody && equalTo((UnauthorizedErrorBody) other);
  }

  private boolean equalTo(UnauthorizedErrorBody other) {
    return reason.equals(other.reason);
  }

  @Override
  public int hashCode() {
    if (_cachedHashCode == 0) {
      _cachedHashCode = Objects.hash(this.reason);
    }
    return _cachedHashCode;
  }

  @Override
  public String toString() {
    return "UnauthorizedErrorBody{" + "reason: " + reason + "}";
  }

  public static ReasonStage builder() {
    return new Builder();
  }

  public interface ReasonStage {
    _FinalStage reason(String reason);

    Builder from(UnauthorizedErrorBody other);
  }

  public interface _FinalStage {
    UnauthorizedErrorBody build();
  }

  @JsonIgnoreProperties(
      ignoreUnknown = true
  )
  static final class Builder implements ReasonStage, _FinalStage {
    private String reason;

    private Builder() {
    }

    @Override
    public Builder from(UnauthorizedErrorBody other) {
      reason(other.getReason());
      return this;
    }

    @Override
    @JsonSetter("reason")
    public _FinalStage reason(String reason) {
      this.reason = reason;
      return this;
    }

    @Override
    public UnauthorizedErrorBody build() {
      return new UnauthorizedErrorBody(reason);
    }
  }
}

]


basic[basic/generated-java/basic-model/src/main/java/com/fern/basic/model/dummy/service/DummyId.java]=[
package com.fern.basic.model.dummy.service;

import com.fasterxml.jackson.annotation.JsonCreator;
import java.lang.Object;
import java.lang.Override;
import java.lang.String;

public final class DummyId {
  private final String value;

  private DummyId(String value) {
    this.value = value;
  }

  @JsonCreator(
      mode = JsonCreator.Mode.DELEGATING
  )
  public static DummyId of(String value) {
    return new DummyId(value);
  }

  @Override
  public boolean equals(Object other) {
    return this == other || (other instanceof DummyId && this.value.equals(((DummyId) other).value));
  }

  @Override
  public int hashCode() {
    return value.hashCode();
  }

  @Override
  public String toString() {
    return value;
  }
}

]


basic[basic/generated-java/basic-server-jersey/build.gradle]=[
plugins {
    id 'java-library'
    id "org.inferred.processors" version "3.6.0"
}

repositories {
    mavenCentral()
    maven {
        url "https://s01.oss.sonatype.org/content/repositories/releases/"
    }
}

dependencies {
    api project(':basic-model')
    api 'io.github.fern-api:exception-utils:0.0.82'
    api 'io.github.fern-api:immutables-utils:0.0.82'
    api 'io.github.fern-api:jackson-utils:0.0.82'
    api 'io.github.fern-api:jersey-utils:0.0.82'
    implementation 'org.slf4j:slf4j-api:1.7.36'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.12.3'
    implementation 'com.fasterxml.jackson.datatype:jackson-datatype-jdk8:2.12.3'
    implementation 'io.github.openfeign:feign-jackson:11.8'
    implementation 'io.github.openfeign:feign-core:11.8'
    implementation 'io.github.openfeign:feign-jaxrs2:11.8'
    implementation 'org.glassfish.jersey.ext:jersey-spring5:2.35'

    annotationProcessor 'org.immutables:value:2.8.8'
    compileOnly 'org.immutables:value-annotations:2.8.8'
}

]


basic[basic/generated-java/basic-server-jersey/src/main/java/com/fern/basic/server/AbstractServiceRegistry.java]=[
package com.fern.basic.server;

import com.fern.basic.server.blog.PostNotFoundErrorExceptionMapper;
import com.fern.basic.server.blog.PostsService;
import com.fern.basic.server.dummy.service.DummyService;
import org.glassfish.jersey.server.ResourceConfig;

public abstract class AbstractServiceRegistry extends ResourceConfig {
  public AbstractServiceRegistry() {
    register(DefaultExceptionMapper.class);
    register(PostNotFoundErrorExceptionMapper.class);
  }

  public AbstractServiceRegistry(PostsService postsService, DummyService dummyService) {
    this();
    register(postsService);
    register(dummyService);
  }
}

]


basic[basic/generated-java/basic-server-jersey/src/main/java/com/fern/basic/server/BearerAuth.java]=[
package com.fern.basic.server;

import com.fasterxml.jackson.annotation.JsonValue;
import java.lang.Override;
import java.lang.String;
import org.immutables.value.Value;

@Value.Immutable
@Value.Style(
    visibility = Value.Style.ImplementationVisibility.PACKAGE,
    jdkOnly = true
)
public abstract class BearerAuth {
  @Value.Parameter
  @JsonValue
  public abstract String getToken();

  @Override
  public final String toString() {
    return "Bearer " + getToken();
  }

  public static BearerAuth of(String token) {
    return ImmutableBearerAuth.of(token.startsWith("Bearer ") ? token.substring(7) : token);
  }
}

]


basic[basic/generated-java/basic-server-jersey/src/main/java/com/fern/basic/server/DefaultExceptionMapper.java]=[
package com.fern.basic.server;

import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.fasterxml.jackson.databind.annotation.JsonSerialize;
import com.fern.java.immutables.AliasImmutablesStyle;
import java.lang.Exception;
import java.lang.Override;
import java.lang.String;
import java.util.UUID;
import javax.ws.rs.core.Response;
import javax.ws.rs.ext.ExceptionMapper;
import org.immutables.value.Value;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public final class DefaultExceptionMapper implements ExceptionMapper<Exception> {
  private static final Logger log = LoggerFactory.getLogger(DefaultExceptionMapper.class);

  @Override
  public Response toResponse(Exception e) {
    DefaultExceptionBody body = DefaultExceptionBody.create();
    log.error("Error handling request. ErrorInstanceId= {}", body.errorInstanceId(), e);
    return Response.status(500).entity(body).build();
  }

  @Value.Immutable
  @AliasImmutablesStyle
  @JsonDeserialize(
      as = ImmutableDefaultExceptionBody.class
  )
  @JsonSerialize(
      as = ImmutableDefaultExceptionBody.class
  )
  interface DefaultExceptionBody {
    @JsonProperty("_error")
    default String errorType() {
      return "_unknown";
    }

    @JsonProperty("_errorInstanceId")
    default String errorInstanceId() {
      return UUID.randomUUID().toString();
    }

    static DefaultExceptionBody create() {
      return ImmutableDefaultExceptionBody.of();
    }
  }
}

]


basic[basic/generated-java/basic-server-jersey/src/main/java/com/fern/basic/server/blog/PostNotFoundErrorExceptionMapper.java]=[
package com.fern.basic.server.blog;

import com.fern.basic.model.blog.PostNotFoundError;
import com.fern.java.jersey.ResourceInfoUtils;
import java.lang.Override;
import javax.ws.rs.container.ResourceInfo;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.Response;
import javax.ws.rs.ext.ExceptionMapper;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public final class PostNotFoundErrorExceptionMapper implements ExceptionMapper<PostNotFoundError> {
  private static final Logger log = LoggerFactory.getLogger(PostNotFoundErrorExceptionMapper.class);

  @Context
  ResourceInfo resourceInfo;

  @Override
  public Response toResponse(PostNotFoundError e) {
    log.info("Error handling request. ErrorInstanceId= {}", e.getErrorInstanceId(), e);
    if (ResourceInfoUtils.getInterfaceNames(resourceInfo).contains("PostsService")) {
      if (ResourceInfoUtils.getMethodName(resourceInfo).contains("getPost")) {
        return Response.status(e.getStatusCode()).entity(com.fern.basic.model.blog.GetPostFailedResponse.postNotFoundError(e)).build();
      }
    }
    return null;
  }
}

]


basic[basic/generated-java/basic-server-jersey/src/main/java/com/fern/basic/server/blog/PostsService.java]=[
package com.fern.basic.server.blog;

import com.fern.basic.model.blog.BlogPost;
import com.fern.basic.model.blog.CreatePostRequest;
import com.fern.basic.model.blog.PostId;
import com.fern.basic.model.blog.PostNotFoundError;
import javax.ws.rs.Consumes;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
@Path("/posts")
public interface PostsService {
  @POST
  @Path("/create")
  void createPost(CreatePostRequest request);

  @GET
  @Path("/{postId}")
  BlogPost getPost(@PathParam("postId") PostId postId) throws PostNotFoundError;
}

]


basic[basic/generated-java/basic-server-jersey/src/main/java/com/fern/basic/server/dummy/service/DummyService.java]=[
package com.fern.basic.server.dummy.service;

import com.fern.basic.model.dummy.service.DummyId;
import com.fern.basic.server.BearerAuth;
import javax.ws.rs.Consumes;
import javax.ws.rs.GET;
import javax.ws.rs.HeaderParam;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
@Path("/dummy")
public interface DummyService {
  @GET
  @Path("/")
  void getDummy(@HeaderParam("Authorization") BearerAuth bearer, DummyId request);
}

]


basic[basic/generated-java/basic-server-spring/build.gradle]=[
plugins {
    id 'java-library'
    id "org.inferred.processors" version "3.6.0"
}

repositories {
    mavenCentral()
    maven {
        url "https://s01.oss.sonatype.org/content/repositories/releases/"
    }
}

dependencies {
    api project(':basic-model')
    api 'io.github.fern-api:exception-utils:0.0.82'
    api 'io.github.fern-api:immutables-utils:0.0.82'
    api 'io.github.fern-api:jackson-utils:0.0.82'
    api 'io.github.fern-api:spring-utils:0.0.82'
    implementation 'org.slf4j:slf4j-api:1.7.36'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.12.3'
    implementation 'com.fasterxml.jackson.datatype:jackson-datatype-jdk8:2.12.3'
    implementation 'org.springframework:spring-web:5.3.19'
    implementation 'org.springframework:spring-webmvc:5.3.19'

    annotationProcessor 'org.immutables:value:2.8.8'
    compileOnly 'org.immutables:value-annotations:2.8.8'
}

]


basic[basic/generated-java/basic-server-spring/src/main/java/com/fern/basic/model/blog/PostNotFoundErrorExceptionMapper.java]=[
package com.fern.basic.model.blog;

import com.fern.java.spring.HandlerMethodUtils;
import java.lang.Object;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.method.HandlerMethod;
import org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler;

@Order(Ordered.HIGHEST_PRECEDENCE)
@ControllerAdvice
public final class PostNotFoundErrorExceptionMapper extends ResponseEntityExceptionHandler {
  private static final Logger log = LoggerFactory.getLogger(PostNotFoundErrorExceptionMapper.class);

  @ExceptionHandler(PostNotFoundError.class)
  public ResponseEntity<Object> handle(PostNotFoundError e, HandlerMethod handlerMethod) {
    log.info("Error handling request. ErrorInstanceId= {}", e.getErrorInstanceId(), e);
    if (HandlerMethodUtils.getInterfaceNames(handlerMethod).contains("PostsService")) {
      if (HandlerMethodUtils.getMethodName(handlerMethod).contains("getPost")) {
        return new ResponseEntity<>(GetPostFailedResponse.postNotFoundError(e), HttpStatus.valueOf(e.getStatusCode()));
      }
    }
    return null;
  }
}

]


basic[basic/generated-java/basic-server-spring/src/main/java/com/fern/basic/server/BearerAuth.java]=[
package com.fern.basic.server;

import com.fasterxml.jackson.annotation.JsonValue;
import java.lang.Override;
import java.lang.String;
import org.immutables.value.Value;

@Value.Immutable
@Value.Style(
    visibility = Value.Style.ImplementationVisibility.PACKAGE,
    jdkOnly = true
)
public abstract class BearerAuth {
  @Value.Parameter
  @JsonValue
  public abstract String getToken();

  @Override
  public final String toString() {
    return "Bearer " + getToken();
  }

  public static BearerAuth of(String token) {
    return ImmutableBearerAuth.of(token.startsWith("Bearer ") ? token.substring(7) : token);
  }
}

]


basic[basic/generated-java/basic-server-spring/src/main/java/com/fern/basic/server/DefaultExceptionMapper.java]=[
package com.fern.basic.server;

import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.fern.java.immutables.AliasImmutablesStyle;
import java.lang.Exception;
import java.lang.Object;
import java.lang.String;
import java.util.UUID;
import org.immutables.value.Value;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler;

@ControllerAdvice
public final class DefaultExceptionMapper extends ResponseEntityExceptionHandler {
  private static final Logger log = LoggerFactory.getLogger(DefaultExceptionMapper.class);

  @ExceptionHandler(Exception.class)
  public ResponseEntity<Object> handleException(Exception e) {
    DefaultExceptionBody body = DefaultExceptionBody.create();
    log.error("Error handling request. ErrorInstanceId= {}", body.errorInstanceId(), e);
    return new ResponseEntity<>(body, HttpStatus.INTERNAL_SERVER_ERROR);
  }

  @Value.Immutable
  @AliasImmutablesStyle
  @JsonDeserialize(
      as = ImmutableDefaultExceptionBody.class
  )
  interface DefaultExceptionBody {
    @JsonProperty("_error")
    default String errorType() {
      return "_unknown";
    }

    @JsonProperty("_errorInstanceId")
    default String errorInstanceId() {
      return UUID.randomUUID().toString();
    }

    static DefaultExceptionBody create() {
      return ImmutableDefaultExceptionBody.of();
    }
  }
}

]


basic[basic/generated-java/basic-server-spring/src/main/java/com/fern/basic/server/blog/PostsService.java]=[
package com.fern.basic.server.blog;

import com.fern.basic.model.blog.BlogPost;
import com.fern.basic.model.blog.CreatePostRequest;
import com.fern.basic.model.blog.PostId;
import com.fern.basic.model.blog.PostNotFoundError;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;

@RequestMapping(
    path = "/posts",
    consumes = "application/json",
    produces = "application/json"
)
public interface PostsService {
  @PostMapping("/create")
  void createPost(@RequestBody CreatePostRequest request);

  @GetMapping("/{postId}")
  BlogPost getPost(@PathVariable("postId") PostId postId) throws PostNotFoundError;
}

]


basic[basic/generated-java/basic-server-spring/src/main/java/com/fern/basic/server/dummy/service/DummyService.java]=[
package com.fern.basic.server.dummy.service;

import com.fern.basic.model.dummy.service.DummyId;
import com.fern.basic.server.BearerAuth;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.bind.annotation.RequestMapping;

@RequestMapping(
    path = "/dummy",
    consumes = "application/json",
    produces = "application/json"
)
public interface DummyService {
  @GetMapping("/")
  void getDummy(@RequestHeader("Authorization") BearerAuth bearer, @RequestBody DummyId request);
}

]


basic[basic/generated-java/settings.gradle]=[
rootProject.name = 'fern-generated-java'

include 'basic-model'
include 'basic-client'
include 'basic-server-spring'
include 'basic-server-jersey'

]